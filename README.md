# Тестовое задание

Веб-сервис для хранения, изменения информации о недвижимости строительной компании.
## Содержание

- [Стек технологий](#стек-технологий)
- [Инструкция по запуску](#инструкция-по-запуску)
- [Использование OpenAPI](#использование-openapi)
- [Описание предметной области](#описание-предметной-области)
- [Время выполнения задания](#время-выполнения-задания)

## Стек технологий
- Java 17
- Maven
- Spring Boot 3.0.5
- Spring Web
- PostgreSQL 13
- PostgreSQL Driver (JDBC and R2DBC)
- Spring Data JPA
- Hibernate validator
- Lombok
- MapStruct 1.5.4
  - Lombok mapstruct-binding 0.2.0
  - Plugins project-lombok
- Docker
  - Docker-compose v.3
- SwaggerEditor 3.0.2

## Инструкция по запуску
Три рассматриваемых варианта запуска веб-сервиса test-work-app:
### Вариант 1 - подключение к серверу

Протестировать работу веб-сервиса можно на запущенном сервере. Для этого не нужно устанавливать и запускать допольнительного ПО, можно сразу перейти в раздел [OpenAPI](#использование-openapi) вариант 1.

*Дополнительная информация: адрес и порт сервера 178.170.193.201:8081*

### Вариант 2 - запуск docker контейнеров

*Для тестирования работы test-work-app достаточно склонировать папку docker-compose со всеми включёнными в неё материалами, а также иметь установленный Docker и Docker-Compose в вашей системе, с поддержкой запуска Linux-контейнеров, чтобы проинициализировать и запустить описанные в docker-compose.yml контейнеры.*
#### Пошагово:
- Склонируйте папку [docker-compose](https://github.com/MrRobinGoood/test-work-app/tree/master/docker-compose), либо весь репозиторий.
- Запустите Docker в вашей системе.
- Для запуска проекта необходимо запустить [docker-compose.yml](https://github.com/MrRobinGoood/test-work-app/blob/master/docker-compose/docker-compose.yml) файл из папки [docker-compose](https://github.com/MrRobinGoood/test-work-app/tree/master/docker-compose). 

Сделать это можно запустив следующую команду в консоли, находясь в директории docker-compose.
```
sudo docker-compose up -d
```
Для того чтобы успешно прошло создание контейнера с базой данных, необходимо, чтобы в [docker-compose](https://github.com/MrRobinGoood/test-work-app/tree/master/docker-compose) находилась папка-зависимость [sql](https://github.com/MrRobinGoood/test-work-app/tree/master/docker-compose/sql), включающая в себя бэкап-файл инициализации бд [init.sql](https://github.com/MrRobinGoood/test-work-app/blob/master/docker-compose/sql/init.sql).

*(Docker контейнеры сформированы под linux)*

### Вариант 3 - самостоятельная сборка проекта

#### Общий план действий:

- Предварительно установить JRE для запуска Java
- Склонировать репозиторий
- В файле [application.properties](https://github.com/MrRobinGoood/test-work-app/blob/master/src/main/resources/application.properties) заменить значение spring.datasource.url на jdbc:postgresql://localhost:5432/RealEstate
- Создать и запустить базу данных PostgreSQL 13, проинициализировав её бэкап-файлом [init.sql](https://github.com/MrRobinGoood/test-work-app/blob/master/docker-compose/sql/init.sql)
- Запустить любым удобным способом файл [TestWorkApplication.java](https://github.com/MrRobinGoood/test-work-app/blob/master/src/main/java/ru/bartenev/testwork/TestWorkApplication.java)

## Использование OpenAPI

### Вариант 1 - с запущенным сервером

Протестировать test-work-app вы можете с помощью SwaggerHub по [ссылке](https://app.swaggerhub.com/apis/MROBINGOOOD/test-work-app-api/0.0.1#/), либо импортировав в ваш [SwaggerEditor](https://editor.swagger.io/) файл [openapi.yaml](https://github.com/MrRobinGoood/test-work-app/blob/master/openapi/openapi.yaml).

### Вариант 2 - с локальными docker контейнерами

Когда docker контейнеры успешно запущены, вы можете протестировать работу веб-сервиса в SwaggerHub по [ссылке](https://app.swaggerhub.com/apis/MROBINGOOOD/test-work-app-api/0.0.2) , либо средствами SwaggerEditor.

Для варианта с [SwaggerEditor](https://editor.swagger.io/) импортируйте файл [openapi.yaml](https://github.com/MrRobinGoood/test-work-app/blob/master/openapi/openapi.yaml) с описанием API, и в 7й строке замените значение ключа url на ```http://localhost:8081/```.

### Вариант 3 - с ручной сборкой проекта

Использование OpenAPI с самостоятельной сборкой проекта повторяет те же действия, что и в варианте 2 с локальными docker контейнерами.

## Описание предметной области

### Задача: 

Создание веб-сервиса для хранения, изменения информации о недвижимости строительной компании.

### Объекты задачи (находящиеся в отношении композиции):
- Здание
- Квартира

*Отношение один ко многим.*

### Бизнес-процессы: 

Создание, получение, обновление, удаление информации о зданиях и их квартирах, принадлежащих строительной компании.

### Характеристики объектов предметной области:

Здание: 
- адрес
- дата постройки
- этажность
- количество подъездов
- наличие парковки

Квартира: 
- площадь
- количество комнат
- этаж
- отделка
- цена 

*При добавлении информации все поля обязательны к заполнению, кроме поля отделка квартиры.*

## Возможные операции над объектами

Здание:

- Создание здания
- Получение информации о конкретном здании
- Обновление информации здания
- Удаление здания
- Получение списка информации о всех зданиях

Квартира:

- Создание квартиры, привязанной к конкретному зданию
- Получение списка информации о квартирах принадлежащих конкретному зданию
- Получение информации о конкретной квартире
- Обновление информации квартиры
- Удаление квартиры

*В случае удаления конкретного здания, все привязанные к нему квартиры будут также удалены.*

## Время выполнения задания
### Итого: 12,5 часов. 
- (1ч) Анализ задачи, создание композиции, выбор технологий
- (1,5ч) Написание OpenAPI
- (0,5ч) Создание структуры бд PostgreSQL
- (0,5ч) Подключение бд к среде разработки, создание базовых сущностей
- (1,5ч) Создание связей между сущностями, создание DTO
- (4ч) Разработка CRUD функционала
- (1ч) Обработка исключений
- (1ч) Отладка и проверка работоспособности
- (1,5ч) Написание Readme, сопроводительной документации
- (Дополнительно 3ч) контейнеризация сервиса в docker-compose

*Время docker не учитывается, т.к это дополнительная задача и это был мой первый опыт работы с docker.*


